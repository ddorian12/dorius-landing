<section class="ea-wrapper">
  <div class="ea-card" *ngIf="!submitted; else thanksTpl">
    <h1>Ãnscrieri vÃ¢nzÄƒtori â€¢ Dorius.ro</h1>
    <p class="subtitle">
      AÈ™a cum am promis, <strong>Ã®n august deschidem Ã®nscrierile</strong> pentru viitorii selleri.
      CompleteazÄƒ formularul È™i te anunÈ›Äƒm imediat ce onboarding-ul complet este disponibil.
    </p>

    <div class="doc-links" aria-label="Documente utile">
      <a class="doc-chip" routerLink="/termeni"> <span class="ic">ğŸ“„</span> Termeni </a>
      <a class="doc-chip" routerLink="/confidentialitate"> <span class="ic">ğŸ”’</span> ConfidenÈ›ialitate </a>
      <a class="doc-chip" routerLink="/comisioane"> <span class="ic">ğŸ’¸</span> Comisioane </a>
    </div>

    <form [formGroup]="form" (ngSubmit)="submit()" novalidate>
      <input formControlName="company" class="hp" tabindex="-1" autocomplete="off" aria-hidden="true">

      <div class="grid">
        <!-- OBLIGATORII -->
        <label>
          <span>Email *</span>
          <input type="email" formControlName="email" placeholder="ex: hello@brand.ro" autocomplete="email"/>
          <small class="err" *ngIf="email.touched && email.invalid" role="alert">Introdu un email valid.</small>
          <small class="hint" *ngIf="email.valid">
            DacÄƒ ai mai trimis o Ã®nscriere cu acest email, noile informaÈ›ii Ã®È›i vor
            <strong>actualiza automat</strong> Ã®nregistrarea existentÄƒ.
          </small>
        </label>

        <label>
          <span>Nume brand / public *</span>
          <input type="text" formControlName="brandName" placeholder="ex: DoriPrints" maxlength="40"/>
          <small class="err" *ngIf="brandName.touched && brandName.invalid" role="alert">
            Numele este obligatoriu (max. 40 caractere).
          </small>
        </label>

        <label>
          <span>PersoanÄƒ de contact *</span>
          <input type="text" formControlName="contactName" placeholder="ex: Ana Popescu" autocomplete="name"/>
          <small class="err" *ngIf="contactName.touched && contactName.invalid" role="alert">
            CompleteazÄƒ persoana de contact.
          </small>
        </label>

        <label>
          <span>OraÈ™ *</span>
          <input type="text" formControlName="city" placeholder="ex: Cluj-Napoca" autocomplete="address-level2"/>
          <small class="err" *ngIf="city.touched && city.invalid" role="alert">CompleteazÄƒ oraÈ™ul.</small>
        </label>

        <label>
          <span>ÈšarÄƒ *</span>
          <select formControlName="country" autocomplete="country">
            <option *ngFor="let c of countries" [value]="c.value">{{ c.label }}</option>
          </select>
          <small class="err" *ngIf="country.touched && country.invalid" role="alert">SelecteazÄƒ È›ara.</small>
        </label>

        <label>
          <span>Tip de produse *</span>
          <select formControlName="productScope">
            <option *ngFor="let o of productScopeOptions" [value]="o.value">{{ o.label }}</option>
          </select>
          <small class="err" *ngIf="productScope.touched && productScope.invalid" role="alert">
            SelecteazÄƒ o opÈ›iune.
          </small>
        </label>

        <label>
          <span>Ce vinzi (scurt)</span>
          <input type="text" formControlName="productTypes" placeholder="ex: ebooks, planificatoare, stickere" maxlength="120"/>
        </label>

        <label>
          <span>Website / Link portofoliu</span>
          <input type="url" formControlName="website" placeholder="ex: https://linktr.ee/brand" maxlength="200" autocomplete="url"/>
        </label>

        <label>
          <span>Statut legal *</span>
          <select formControlName="legalStatus">
            <option value="">â€” selecteazÄƒ â€”</option>
            <option *ngFor="let s of legalStatusOptions" [value]="s.value">{{ s.label }}</option>
          </select>

          <small class="err" *ngIf="legalStatus.touched && legalStatus.invalid" role="alert">
            SelecteazÄƒ statutul legal.
          </small>

          <small *ngIf="legalStatus.value === 'none'" class="hint">
            PoÈ›i trimite Ã®nscrierea acum. Pentru a primi plÄƒÈ›i la onboarding va fi necesar PFA/II/IF sau SRL/SA.
          </small>
        </label>

        <div class="full">
          <span class="label-inline">Unde vinzi acum?</span>
          <div class="chips">
            <button type="button" class="chip" [class.active]="hasChannel('Website')"   (click)="toggleChannel('Website')">Website propriu</button>
            <button type="button" class="chip" [class.active]="hasChannel('Instagram')" (click)="toggleChannel('Instagram')">Instagram</button>
            <button type="button" class="chip" [class.active]="hasChannel('TikTok')" (click)="toggleChannel('TikTok')">TikTok</button>
            <button type="button" class="chip" [class.active]="hasChannel('Etsy')"      (click)="toggleChannel('Etsy')">Etsy</button>
            <button type="button" class="chip" [class.active]="hasChannel('eMAG')"      (click)="toggleChannel('eMAG')">eMAG</button>
            <button type="button" class="chip" [class.active]="hasChannel('Alt marketplace')" (click)="toggleChannel('Alt marketplace')">Alt marketplace</button>
          </div>
        </div>

        <label>
          <span>Disponibilitate *</span>
          <select formControlName="readiness">
            <option value="now">Vreau sÄƒ Ã®ncep Ã®n â‰¤30 zile</option>
            <option value="later">MÄƒ intereseazÄƒ, dar mai tÃ¢rziu</option>
          </select>
          <small class="err" *ngIf="readiness.touched && readiness.invalid" role="alert">
            Spune-ne disponibilitatea.
          </small>
        </label>
      </div>

      <!-- DETALII OPÈšIONALE (collapsible) -->
      <details class="optional">
        <summary>Detalii opÈ›ionale (â‰ˆ1 min) â€“ ne ajuÈ›i sÄƒ te aprobÄƒm mai repede</summary>
        <div class="grid opt-grid">
          <label>
            <span>Instagram</span>
            <input type="text" formControlName="instagram" placeholder="URL sau @handle" maxlength="120"/>
          </label>

          <label>
            <span>TikTok</span>
            <input type="text" formControlName="tiktok" placeholder="URL sau @handle" maxlength="120"/>
          </label>

          <label>
            <span>Volum estimat/lunÄƒ</span>
            <select formControlName="estOrdersPerMonth">
              <option value="">â€” alege â€”</option>
              <option *ngFor="let r of estOrdersOptions" [value]="r">{{ r }}</option>
            </select>
          </label>

          <label>
            <span>Fulfillment</span>
            <select formControlName="fulfillment">
              <option value="">â€” selecteazÄƒ â€”</option>
              <option *ngFor="let f of fulfillmentOptions" [value]="f.value">{{ f.label }}</option>
            </select>
          </label>

          <label class="checkline">
            <input type="checkbox" formControlName="hasIPRights"/>
            <span>Declar cÄƒ deÈ›in drepturile/licenÈ›ele pentru produsele listate</span>
          </label>

          <label>
            <span>Cum ai aflat de noi?</span>
            <select formControlName="referral">
              <option value="">â€” selecteazÄƒ â€”</option>
              <option *ngFor="let r of referralOptions" [value]="r">{{ r }}</option>
            </select>
          </label>

          <label class="checkline">
            <input type="checkbox" formControlName="marketingOptIn"/>
            <span>Vreau sÄƒ primesc noutÄƒÈ›i & update-uri pentru selleri</span>
          </label>
        </div>
      </details>

      <div class="terms-row">
        <label class="terms">
          <input type="checkbox" formControlName="acceptTerms" />
          <span>
            Sunt de acord cu
              <a routerLink="/termeni">Termenii</a> È™i
              <a routerLink="/confidentialitate">Politica de confidenÈ›ialitate</a>,
              precum È™i cu <a routerLink="/comisioane">Comisioanele</a>.
          </span>

          <button type="button" class="info-btn" (click)="openTerms()" aria-label="Vezi pe scurt Termenii & Politica">
            <img src="assets/info.svg" class="nav-icon" width="20" height="20" alt="" />
          </button>
        </label>

        <small class="err terms-err" *ngIf="acceptTerms.touched && acceptTerms.invalid" role="alert">
          Trebuie sÄƒ accepÈ›i termenii.
        </small>
      </div>

      <button class="btn" type="submit" [disabled]="submitting || form.invalid" [attr.aria-busy]="submitting">
        <span *ngIf="!submitting">Ãnscrie-mÄƒ</span>
        <span *ngIf="submitting">Se trimiteâ€¦</span>
      </button>

      <p class="error" *ngIf="errorMsg">{{ errorMsg }}</p>
      <p class="footnote">Nu trimitem spam. PoÈ›i solicita oricÃ¢nd È™tergerea datelor.</p>
    </form>
  </div>

  <ng-template #thanksTpl>
    <div class="ea-card success" tabindex="-1">
      <h1>ğŸ‰ MulÈ›umim!</h1>
      <p>Te-ai Ã®nscris cu succes pe lista de aÈ™teptare pentru vÃ¢nzÄƒtori. Revenim pe email foarte curÃ¢nd.</p>
      <a class="btn" href="/">Ãnapoi la pagina principalÄƒ</a>
    </div>
  </ng-template>

  <!-- Modal Termeni -->
  <div class="modal-backdrop" *ngIf="showTerms" (click)="closeTerms()"></div>
  <div class="modal" *ngIf="showTerms" role="dialog" aria-modal="true" aria-labelledby="termsTitle" (keydown.escape)="closeTerms()">
    <div class="modal-card">
      <header class="modal-head">
        <h2 id="termsTitle">Termeni & Politica (pe scurt)</h2>
        <button type="button" class="modal-close" (click)="closeTerms()" aria-label="Ãnchide">Ã—</button>
      </header>
      <div class="modal-body">
        <ul>
          <li>Datele trimise sunt folosite pentru contactarea ta la deschiderea onboarding-ului.</li>
          <li>PoÈ›i cere oricÃ¢nd È™tergerea datelor (contact&#64;dorius.ro).</li>
          <li>Nu vindem È™i nu partajÄƒm datele tale Ã®n scopuri de marketing ale terÈ›ilor.</li>
        </ul>
        <p>Versiunea completÄƒ:
          <a href (click)="navigateFromModal('/termeni', $event)">Termenii</a> È™i
          <a href (click)="navigateFromModal('/confidentialitate', $event)">Politica de confidenÈ›ialitate</a>,
          precum È™i <a href (click)="navigateFromModal('/comisioane', $event)">Comisioane</a>.
        </p>
      </div>
    </div>
  </div>

  <!-- Backdrop modal Comisioane -->
  <div class="modal-backdrop" *ngIf="showFees" (click)="closeFees()"></div>

  <!-- Modal Comisioane (previzualizare PDF) -->
  <div class="modal" *ngIf="showFees" role="dialog" aria-modal="true" aria-labelledby="feesTitle" (keydown.escape)="closeFees()">
    <div class="modal-card wide">
      <header class="modal-head">
        <h2 id="feesTitle">Comisioane Dorius.ro</h2>
        <a class="btn-link" href="assets/policies/comisioane-dorius.pdf" target="_blank" rel="noopener noreferrer">Deschide Ã®n fereastrÄƒ nouÄƒ</a>
        <button type="button" class="modal-close" (click)="closeFees()" aria-label="Ãnchide">Ã—</button>
      </header>
      <div class="modal-body pdf-body">
        <iframe
          class="pdf-frame"
          src="assets/policies/comisioane-dorius.pdf#view=FitH"
          title="Comisioane Dorius.ro (PDF)"
        ></iframe>
      </div>
    </div>
  </div>
</section>
